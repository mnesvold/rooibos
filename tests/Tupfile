include_rules

ROOIBUS = $(TUP_CWD)/../rooibus/rooibus-codegen

: source.c |> $(BIN)/clang -S -emit-llvm -o %o -O %f |> ir.ll
: source.c |> $(BIN)/clang -c -emit-llvm -o %o -O %f |> bitcode.bc
: bitcode.bc | $(ROOIBUS) |> $(ROOIBUS) < %f > %o |> asm.json
: asm.json |> diff expected.js %f && touch %o |> ok
